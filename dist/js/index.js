var data,len,indexControl,timer,root=window.player,audio=root.audioManager,pro=root.pro,songList=root.songList,nowIndex=0;function getData(o){$.ajax({url:o,type:"GET",success:function(o){window.data=o,len=o.length,indexControl=new root.indexControl(len),root.render(o[0]),root.songList.initList(o),audio.getAudio(o[0].audio),pro.allTime(o[0]),bindEvent(),bindTouch()},error:function(){}})}function bindEvent(){$("body").on("change",function(o,t){nowIndex=t,root.render(data[t]),audio.getAudio(data[t].audio),pro.allTime(data[t]),songList.changeListSong(t),"play"==audio.status&&(audio.play(),pro.start(data[nowIndex]),$(".imgbox").css({transform:"rotateZ(0)",transition:"none"}),rotated(0)),pro.updata("init")}),$(".prev").on("click",function(){var o=indexControl.prev();$("body").trigger("change",o)}),$(".next").on("click",function(){var o=indexControl.next();$("body").trigger("change",o)}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),pro.start(data[nowIndex]),rotated($(".imgbox").attr("data-deg"))):(audio.pause(),clearInterval(timer),pro.stop()),$(".play").toggleClass("playing")}),$(".isLike").on("click",function(){$(".isLike").toggleClass("liked")}),$(".list").on("click",function(o){o.stopPropagation(),$(".song-list").addClass("show")}),$(".song-list").on("click",function(o){o.stopPropagation()}),$("body").on("click",function(){$(".song-list").removeClass("show")})}function rotated(o){clearInterval(timer);o=+o;timer=setInterval(function(){o+=1.5,$(".imgbox").attr("data-deg",o),$(".imgbox").css({transform:"rotateZ("+o+"deg)",transition:"all .4s linear"})},200)}function bindTouch(){var n,o=$(".slider"),a=$(".pro-top"),t=$(".pro-bottom").offset(),i=t.width,r=t.left;function e(o){var t=o.changedTouches[0].clientX-r>i?i:o.changedTouches[0].clientX-r;return n=(t=0<=t?t:0)/i*audio.audio.duration,a.css({width:t}),$(".curTime").html(pro.transformTime(n)),audio.audio.currentTime=n,"play"==audio.status&&(audio.play(),rotated($(".imgbox").attr("data-deg"))),pro.start(data[nowIndex]),!1}o.on("touchstart",function(o){o.stopPropagation(),pro.stop()}).on("touchmove",function(o){var t=o.changedTouches[0].clientX-r>i?i:o.changedTouches[0].clientX-r;n=(t=0<=t?t:0)/i*audio.audio.duration,a.css({width:t}),$(".curTime").html(pro.transformTime(n))}).on("touchend",function(){audio.audio.currentTime=n,"play"==audio.status&&(audio.play(),rotated($(".imgbox").attr("data-deg"))),pro.start(data[nowIndex])}),$(".pro-bottom").on("touchstart",function(o){e(o)}),$(".pro-top").on("touchstart",function(o){e(o)})}getData("../mock/data.json");